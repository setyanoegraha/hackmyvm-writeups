# 0x18

This write-up walks through how mission 0x18 was completed, moving from user `clara` to `frida` and secured `frida`'s flag.

---

As usual:

```bash
clara@venus:~$ cat mission.txt 
################
# MISSION 0x18 #
################

## EN ##
The password of user frida is in the password-protected zip (rockyou.txt can help you)

## ES ##
La password de frida esta en el zip protegido con password.(rockyou.txt puede ayudarte)
```

The target machine lacks `john` or `zip2john`. The `protected.zip` file must be transferred to our local attack machine.

```bash
┌──(kali㉿kali)-[~]
└─$ scp -P 5000 clara@venus.hackmyvm.eu:~/protected.zip .
clara@venus.hackmyvm.eu's password:
protected.zip                  100%  244     0.6KB/s   00:00
```

Once on our local machine, we use `zip2john` to extract the password hash.

```bash
┌──(kali㉿kali)-[~]
└─$ zip2john protected.zip > protected.hash
ver 1.0 efh 5455 efh 7875 protected.zip/pwned/clara/protected.txt PKZIP Encr: 2b chk, TS_chk, cmplen=28, decmplen=16, crc=239F7473 ts=3383 cs=3383 type=0
```
Using john and the recommended `rockyou.txt` wordlist, we crack the hash.

```bash
┌──(kali㉿kali)-[~]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt protected.hash
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
No password hashes left to crack (see FAQ)
```
We reveal the cracked ZIP password using `john --show`.


```bash
┌──(kali㉿kali)-[~]
└─$ john --show protected.hash
protected.zip/pwned/clara/protected.txt:pass123:pwned/clara/protected.txt:protected.zip::protected.zip
The password for the zip file is pass123.
```
Now, we unzip the file to get the contents, which will contain frida's password.

```bash
┌──(kali㉿kali)-[~]
└─$ unzip protected.zip
Archive:  protected.zip
[protected.zip] pwned/clara/protected.txt password:
 extracting: pwned/clara/protected.txt
```

Reading the file reveals the password for user frida.

```Bash
┌──(kali㉿kali)-[~]
└─$ cat pwned/clara/protected.txt
[REDACTED]
```

Using the password from the text file, we switch back to the venus machine and `su` to frida.

```Bash
clara@venus:~$ su - frida
Password: 
frida@venus:~$ whoami ; id
frida
uid=1019(frida) gid=1019(frida) groups=1019(frida)
```

Finally, we read the flag.

```bash
frida@venus:~$ cat flagz.txt 
[REDACTED]
```